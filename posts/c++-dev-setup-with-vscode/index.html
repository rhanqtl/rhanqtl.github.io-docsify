<!doctype html><html lang=zh-cn><head><title>Visual Studio Code C/C++ 开发环境搭建 · rhanqtl</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="rhanqtl"><meta name=description content="-"><meta name=keywords content="blog,developer,personal,博客,开发者,个人网站"><meta name=twitter:card content="summary"><meta name=twitter:title content="Visual Studio Code C/C++ 开发环境搭建"><meta name=twitter:description content="-"><meta property="og:title" content="Visual Studio Code C/C++ 开发环境搭建"><meta property="og:description" content="-"><meta property="og:type" content="article"><meta property="og:url" content="https://rhanqtl.github.io/posts/c++-dev-setup-with-vscode/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-13T10:50:20+08:00"><meta property="article:modified_time" content="2023-02-13T10:50:20+08:00"><link rel=canonical href=https://rhanqtl.github.io/posts/c++-dev-setup-with-vscode/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.0669b62fc2c181a12a4ba10be9984e385c9a5e83dc7cb7ae3759ad0b98d7e8b2.css integrity="sha256-Bmm2L8LBgaEqS6EL6ZhOOFyaXoPcfLeuN1mtC5jX6LI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.111.3"></head><body class="preload-transitions colorscheme-light"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>rhanqtl</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>原创博文</a></li><li class=navigation-item><a class=navigation-link href=/translations/>翻译</a></li><li class=navigation-item><a class=navigation-link href=/poems/>喜欢的诗歌</a></li><li class=navigation-item><a class=navigation-link href=/projects/>作品</a></li><li class=navigation-item><a class=navigation-link href=/about/>关于我</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://rhanqtl.github.io/posts/c++-dev-setup-with-vscode/>Visual Studio Code C/C++ 开发环境搭建</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-02-13T10:50:20+08:00>February 13, 2023</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
阅读时间：1 分钟</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/c/c++/>C/C++</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/vs-code/>VS Code</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/%E5%B7%A5%E5%85%B7%E9%93%BE/>工具链</a></span></div></div></header><div class=post-content><h1 id=安装-vs-code>安装 VS Code
<a class=heading-link href=#%e5%ae%89%e8%a3%85-vs-code><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><p><a href=https://code.visualstudio.com class=external-link target=_blank rel=noopener>官网</a>
下载</p><blockquote><p>小技巧：如果官网下载比较慢，可以把下载地址中的 <code>az764295.vo.msecnd.net</code> 更换为 <code>vscode.cdn.azure.cn</code></p></blockquote><h1 id=安装-clangdclangd-homepage>安装 clangd<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
<a class=heading-link href=#%e5%ae%89%e8%a3%85-clangdclangd-homepage><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><p>在 Arch Linux 上，<code>clangd</code> 在 <code>clang</code> 这个包中，用如下命令安装：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pacman -S clang
</span></span></code></pre></div><blockquote><p>其他平台可能会使用 <code>clang-extra-tools</code> 这个名称</p></blockquote><h1 id=生成-compile_commandsjson>生成 compile_commands.json
<a class=heading-link href=#%e7%94%9f%e6%88%90-compile_commandsjson><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><p>以 CMake 为例（所以你需要安装 CMake），项目目录结构如下：</p><p><img src=./images/project-structure.png alt=项目目录结构></p><p>首先使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cmake -S . -B build -DCMAKE_EXPORT_COMPILE_COMMANDS<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>配置项目，然后你会看到 <code>build</code> 目录下有一个 <code>compile_commands.json</code> 文件</p><h1 id=配置-clangd>配置 clangd
<a class=heading-link href=#%e9%85%8d%e7%bd%ae-clangd><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><p>如果你安装了 M$ 默认的 cpp-tools，首先需要在 VS Code 中将一些功能关掉（设为 <code>disabled</code>），包括：</p><ul><li><code>C_Cpp.autocomplete</code></li><li><code>C_Cpp.errorSquiggles</code></li><li><code>C_Cpp.intelliSenseEngine</code></li><li><code>C_Cpp.intelliSenseEngineFallback</code></li></ul><blockquote><p>在配置之前，你应该会看到 <code>*.cpp</code> 文件中的 <code>#include "stringutil.hpp"</code> 报错，因为这个头文件在当前目录下找不到。</p></blockquote><p>然后，打开 clangd 插件的配置，在“Clangd: Arguments”加入如下的内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>--background-index
</span></span><span style=display:flex><span>--completion-style=detailed
</span></span><span style=display:flex><span>--all-scopes-completion
</span></span><span style=display:flex><span>--clang-tidy
</span></span><span style=display:flex><span>--enable-config
</span></span><span style=display:flex><span>--log=verbose
</span></span><span style=display:flex><span>--pretty
</span></span><span style=display:flex><span>--pch-storage=memory
</span></span><span style=display:flex><span>--header-insertion=iwyu
</span></span><span style=display:flex><span>--ranking-model=heuristics
</span></span><span style=display:flex><span>--completion-parse=auto
</span></span><span style=display:flex><span>--fallback-style=Google
</span></span><span style=display:flex><span>--compile-commands-dir=build
</span></span></code></pre></div><p>当然，你也可以选择在项目根目录下创建 <code>.vscode/settings.json</code> 文件然后将如下内容加入：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;clangd.arguments&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--all-scopes-completion&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--background-index&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--clang-tidy&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--compile-commands-dir=build&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--completion-parse=auto&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--completion-style=detailed&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--enable-config&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--fallback-style=Google&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--header-insertion=iwyu&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--log=verbose&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--pch-storage=memory&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--pretty&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;--ranking-model=heuristics&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后使用 <code>Ctrl-Shift-P</code> 开启命令面板，选择 <code>clangd: Restart language server</code> 运行，应该就会看到之前的报错消失了。</p><h1 id=调试>调试
<a class=heading-link href=#%e8%b0%83%e8%af%95><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><p>安装插件 CodeLLDB（ID 为 <code>vadimcn.vscode-lldb</code>）。在 <code>launch.json</code> 加入如下内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Use IntelliSense to learn about possible attributes.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// Hover to view descriptions of existing attributes.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Debug&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;lldb&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}/build/a.out&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;args&#34;</span>: [ <span style=color:#e6db74>&#34;-arg1&#34;</span>, <span style=color:#e6db74>&#34;-arg2&#34;</span> ],
</span></span><span style=display:flex><span>            <span style=color:#75715e>// &#34;preLaunchTask&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=参考>参考
<a class=heading-link href=#%e5%8f%82%e8%80%83><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h1><ol><li><a href=https://ahemery.dev/2020/08/24/c-cpp-vscode/ class=external-link target=_blank rel=noopener>My C/C++ Dev Setup with VSCode - ANT-HEM&rsquo;S TECH BLOG</a></li><li><a href=https://juejin.cn/post/7126880493668139021 class=external-link target=_blank rel=noopener>为vscode配置clangd</a></li><li><a href=https://github.com/vadimcn/codelldb/blob/v1.9.0/MANUAL.md class=external-link target=_blank rel=noopener>CodeLLDB Manual</a></li></ol><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://clangd.llvm.org/ class=external-link target=_blank rel=noopener>https://clangd.llvm.org/</a>
&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2023
rhanqtl
·
技术支持 <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>